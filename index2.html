<!DOCTYPE html>
<html>
<head>
    <title>Rotating Rods Animation</title>
    <style>
        canvas {
            border: 0px solid black;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    <script>
        // Adjustable parameters
        const params = {
            rod1Length: 120,    // Length of first rod
            rod2Length: 110,     // Length of second rod
            rod3Length: 100,     // Length of second rod
            rod1Speed: 0.15,    // Rotation speed of first rod
            rod2Speed: 0.01415926535,    // Rotation speed of second rod
            rod3Speed: 0.097,    // Rotation speed of first rod
            traceLength: 6000,   // Number of points to keep in the trace
            canvasSize: 700,     // Canvas width and height
            pointsPerFrame: 100,  // number of points added for the next frame (speed of animation)
            showRods: false
        };

        const paramsArray = [
            [0.7192, 0.1661, 0.0970, 6000],
            [0.5859, 0.3908, 0.0970, 4000],
            [0.9491, 0.0943, 0.5702, 4000],
            [0.8430, 0.2536, 0.4066, 4000],
            [0.8293, 0.3958, 0.3557, 4500],
            [0.0825, 0.8394, 0.1274, 4888],
            [0.1869, 0.2829, 0.0020, 5500],
            [0.1257, 0.2531, 0.8203, 5000],
            [0.7560, 0.0587, 0.4183, 3629],
            [0.6715, 0.5785, 0.7181, 6000],
            [0.1738, 0.8812, 0.5799, 5000],
            [0.0459, 0.0303, 0.7239, 6000],
            [0.4906, 0.1704, 0.9403, 3700],
            [0.5182, 0.2690, 0.6720, 6000],
            [0.3313, 0.1815, 0.5861, 6000],
            [0.1373, 0.9311, 0.0895, 4500],
            [0.5746, 0.0108, 0.0098, 5000],
        ];

        // Setup canvas
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = params.canvasSize;
        canvas.height = params.canvasSize;
        const centerX = canvas.width / 2;
        const centerY = canvas.height / 2;
        ctx.translate(0.5,0.5);
        document.addEventListener("keyup",keyup);

        // Track trace points
        let tracePoints = [];
        let angle1 = 0;
        let angle2 = 0;
        let angle3 = 0;

        function keyup(event) {
            if (event.key=="R") params.showRods = !params.showRods;
            else if (event.key==" ") {
                params.rod1Speed=Math.random();
                params.rod2Speed=Math.random();
                params.rod3Speed=Math.random();
                params.traceLength=Math.floor(6000*Math.random());
            }
            else if (event.key>="a" && event.key<="q") {
                let c = event.key.charCodeAt(0)-97;
                fillParams(paramsArray[c]);
            }
        }

        function fillParams(p) {
            tracePoints=[];
            params.rod1Speed=p[0];
            params.rod2Speed=p[1];
            params.rod3Speed=p[2];
            params.traceLength=p[3];
        }

        function animate() {
            // Clear canvas
            ctx.fillStyle = 'white';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            var x1,y1,x2,y2,x3,y3;

            for (let i=0; i<params.pointsPerFrame; i++) {

                // Calculate rod endpoints
                x1 = centerX + Math.cos(angle1) * params.rod1Length;
                y1 = centerY + Math.sin(angle1) * params.rod1Length;
                x2 = x1 + Math.cos(angle2) * params.rod2Length;
                y2 = y1 + Math.sin(angle2) * params.rod2Length;
                x3 = x2 + Math.cos(angle3) * params.rod3Length;
                y3 = y2 + Math.sin(angle3) * params.rod3Length;

                // Add new trace point
                tracePoints.push({x: x3, y: y3});
                while (tracePoints.length > params.traceLength && tracePoints.length > params.pointsPerFrame) {
                    tracePoints.shift();
                }

                // Update angles
                angle1 += params.rod1Speed;
                angle2 += params.rod2Speed;
                angle3 += params.rod3Speed;
            }

            // Draw trace
            ctx.beginPath();
            ctx.strokeStyle = 'rgba(200, 0, 0, 0.5)';
            ctx.lineWidth = 1;
            for (let i = 0; i < params.traceLength; i++) if (i<tracePoints.length) {
                const point = tracePoints[i];
                if (i === 0) {
                    ctx.moveTo(point.x, point.y);
                } else {
                    ctx.lineTo(point.x, point.y);
                }
            }
            ctx.stroke();

            // Write params
            ctx.beginPath();
            ctx.fillStyle="black";
            ctx.font="16px Arial";
            ctx.fillText(params.rod1Speed,550,20);
            ctx.fillText(params.rod2Speed,550,35);
            ctx.fillText(params.rod3Speed,550,50);
            ctx.fillText(params.traceLength,550,65);

            // Draw rods
            if (params.showRods) {
                ctx.beginPath();
                ctx.strokeStyle = 'black';
                ctx.lineWidth = 2;
                ctx.moveTo(centerX, centerY);
                ctx.lineTo(x1, y1);
                ctx.lineTo(x2, y2);
                ctx.lineTo(x3, y3);
                ctx.stroke();
            }

            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html> 
